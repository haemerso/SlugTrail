<!DOCTYPE html>
<!--this is our base html file, the first working html page with xml database involved-->
<html>
    
<head>

  <title>SlugTrail</title>
    
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    
  <link rel="stylesheet" href="bower_components/html5-boilerplate/dist/css/normalize.css">
  <link rel="stylesheet" href="bower_components/html5-boilerplate/dist/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="app.css">
  <link rel="stylesheet" href="stupid.css" type="text/css" /> 
  <link ref="stylesheet" href="index.css" type="text/css" />
    
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script> 
  <script src="bower_components/html5-boilerplate/dist/js/vendor/modernizr-2.8.3.min.js"></script>
 
</head>

<body>
    <p id="p1"></p>
    <!--input type=text" id="myInput" onkeyup="myFunction()" 
           placeholder="Search for rooms.."-->
    
    <style>
            #to-top{
                position:fixed;
                bottom: 5em;
                right: 0em;
            }
	    
	    //not used in this page
            .frame{
                height: auto;
                width: 300px;
                position: relative;
                padding-bottom: 66.6%;
                overflow: hidden;
            }
            
            img{
                
                top: 100%; bottom: 100%;
                margin: auto;
                width: 100%;
                height: auto;
                max-width: 200px;//maximum width of image
            }
        </style>
    <a class="btn white padded" id="to-top" onclick="goTop()"><i class ="fa fa-angle-double-up fa-5x"></i>TOP</a>
    <div class="header">
        <br/>
        <div class="center"> <h1>Kresge College</h1></div>
        <div class ="border">
            <div class ="center padded">
                <a href = "index.html"><span class = "glyphicon glyphicon-home"></span></a>
                
                <style>
                .glyphicon{
                    margin-right: 20px;
                    font-size: 30px;
                    color: white;
                </style>
                
                <button class="btn yellow rounded" onclick="showSet1()">159 (Seminar Room)</button>  
                <button class="btn yellow rounded" onclick="showSet2()">194</button>
                <button class="btn yellow rounded" onclick="showSet3()">317</button>
                <button class="btn yellow rounded" onclick="showSet4()">319</button>
                <button class="btn yellow rounded" onclick="showSet5()">321</button>
                <button class="btn yellow rounded" onclick="showSet6()">323</button>
                <button class="btn yellow rounded" onclick="showSet7()">325</button>
                <button class="btn yellow rounded" onclick="showSet8()">327</button> 
            </div>
        </div>
    </div>
    
<!--        <script>
                $("button").on("click", function(){
                    $("button").removeClass("selected");
                    $(this).addClass("selected")});
            </script>-->
    <table>   
            <tr>
            <th><img id="map_slot1" style="width:20em"></th>
	    <br>
    </table>
            
    <div class="center">
        <table class="center" id="demo"></table>
    </div>         
    
    <div ng-view></div>
    
    <script>
	//var selection = "R159";
	//it turned out that a null selection is not causing any problem.
        var selection = null; //the current room selection
        
	function showSet1(){
            selection = "R159";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge159/seminar.png");
        }
        
        function showSet2(){
            selection = "R194";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge194/194.png");
        }
        
        function showSet3(){
            selection = "R317";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge317/317.png");
        }
        function showSet4(){
            selection = "R319";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge319/319.png");
        }
        function showSet5(){
            selection = "R321";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge321/mapkresge321.png");
        }
        function showSet6(){
            selection = "R323";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge323/325, 323.png");
        }
        function showSet7(){
            selection = "R325";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge325/325.png");
        }
        function showSet8(){
            selection = "R327";
            loadXMLDoc();
            showMap("map_slot1", "slugtrail-colleges_and_departments/kresge/kresge327/327.png");
        }
            
        function loadXMLDoc(){
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function() {
                if(this.readyState == 4 && this.status == 200)
                    getDataSet(this);
		//debug alerts, check if the database exists and could be connected
		//ready state and status reference:
		//https://www.w3schools.com/xml/dom_httprequest.asp
		/*
		else if (this.status == 404) alert("db not found!");
		else if (this.readyState == 0) alert("request not initiallized!");
		else if (this.readyState == 1) alert("server connection estalished!");
		else if (this.readyState == 2) alert("request received!");
		else if (this.readyState == 3) alert("processing request!");
		*/
                //else alert("this is ballocks!");
            };
            xmlhttp.open("GET", "db_kresge.xml", true); //get data from database
            xmlhttp.send();
        }
        
        function showMap(slot_num, src){
            var img = document.createElement("img");
            var snum = slot_num;
            img.src = src;
            var el = document.getElementById(slot_num);
            el.style.position = "fixed";
            el.style.bottom = 0;
            el.style.right = 0;
            //el.style.paddingTop= "245px";
            el.src = img.src;
        }
        
        function getDataSet(xml){
            var i;//var in for loop
            var xmlDoc = xml.responseXML;
		
	    //first row in table, title. 
	    //set to empty string if title is not needed
            var table = "<tr><th>Image</th><th>Description</th></tr>";

            var x = xmlDoc.getElementsByTagName(selection);
            //if (x == null) alert("x is nul!");
	    //it turned out that the missing tags in xml database is causing the problem.

	    //for each pair of data in the database, insert the image and dscription into the table
            for(i = 0; i < x.length; i++){
                table += "<tr><td><img src=" + 
                        x[i].getElementsByTagName("IMGSRC") [0].childNodes[0].nodeValue +
                        " ></img></td><td>" + 
                        x[i].getElementsByTagName("DSCPT") [0].childNodes[0].nodeValue + 
                        "</td></tr>";
            }
            document.getElementById("demo").innerHTML = table;
        }
        
        
        //go to tbe top button
        function goTop(){
          scroll(0,0);
        }
    </script>
</body>
</html>
